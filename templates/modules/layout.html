<!doctype html>
<html class="scroll-smooth" th:lang="${#locale.toLanguageTag}" th:fragment="html (head,content)" xmlns:th="https://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <meta content="width=device-width, initial-scale=1, minimum-scale=1" name="viewport" />
    <title th:text="${title}"></title>
    <link rel="stylesheet" th:href="@{/assets/css/style.css?v={version}(version=${theme.spec.version})}" />
    <script th:src="@{/assets/js/main.js?v={version}(version=${theme.spec.version})}"></script>
    <th:block th:if="${head != null}">
      <th:block th:replace="${head}" />
    </th:block>
  </head>
  <body class="bg-gray-100 font-sans text-gray-900 transition-colors duration-200 dark:bg-gray-900 dark:text-white/70">
    <th:block th:replace="~{modules/loading}" />
    <th:block th:replace="${content}" />
    <button
    id="back-to-top"
    class="pointer-events-none fixed right-8 bottom-8 z-50 flex h-12 w-12 items-center justify-center rounded-full bg-white opacity-0 shadow-lg inset-ring inset-ring-gray-200 backdrop-blur-md transition-opacity duration-300 dark:bg-white/10 dark:inset-ring-white/10"
    aria-label="回到顶部"
  >
    <svg class="h-5 w-5 text-gray-900 dark:text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"/>
    </svg>
  </button>
  </body>
  <script defer th:src="@{/assets/js/axios.min.js?v={version}(version=${theme.spec.version})}"></script>
  <script th:inline="javascript">
    const i18n = {
      text: /*[[#{widget.loadMore.text}]]*/,
      loading: /*[[#{widget.loadMore.loading}]]*/,
      complete: /*[[#{widget.loadMore.complete}]]*/,
      error: /*[[#{widget.loadMore.error}]]*/
    };
    initLoadMoreForPage({
      postsContainerSelector: 'ul[class*="grid"]',
      getNextPageUrl: (page) => `/page/${page}`,
      postSelector: "li",
      insertPosition: "append",
      i18n
    });
    initLoadMoreForPage({
      postsContainerSelector: "ul.category-post",
      getNextPageUrl: (page) => {
        const path = window.location.pathname.replace(/\/p\d+$/, "");
        return `${path}/page/${page}`;
      },
      postSelector: "li",
      insertPosition: "before",
      i18n
    });
    initLoadMoreForPage({
      postsContainerSelector: "#archive-post-wrapper",
      getNextPageUrl: (page) => {
        const path = window.location.pathname.replace(/\/page\/\d+$/, "");
        return `${path}/page/${page}`;
      },
      postSelector: ".archive-post",
      insertPosition: "before",
      minPostsThreshold: 1,
      onInsert: (newNodes) => {
        newNodes.forEach((monthNode) => {
          monthNode.querySelectorAll("li").forEach((li) => loadPostImages(li));
        });
      },
      i18n
    });
    initLoadMoreForPage({
      postsContainerSelector: "ul.tag-post",
      getNextPageUrl: (page) => {
        const path = window.location.pathname.replace(/\/page\/\d+$/, "");
        return `${path}/page/${page}`;
      },
      postSelector: "li",
      insertPosition: "before",
      i18n
    });
  </script>
</html>
